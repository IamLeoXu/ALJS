<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ALJS 比赛详情 - 液体百科</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #161616;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
    }
    .navbar { background-color: #6B46C1; }
        .navbar {   background-color: rgba(107, 70, 193, 0.5);
                    backdrop-filter: blur(10px);
                    color: #fff;
                }
    .team-card {
      background: rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      margin-bottom: 10px;
      padding: 15px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .team-card:hover {
      background: rgba(0,0,0,0.8);
    }
    .team-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .team-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .team-logo {
      width: 32px;
      height: 32px;
      background: #444;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .team-name {
      font-size: 1.2rem;
      font-weight: bold;
    }
    .team-stats {
      display: flex;
      gap: 20px;
      font-size: 0.9rem;
    }
    .team-stats div {
      text-align: center;
    }
    /* 子表格样式 */
    .player-table-wrapper {
      margin-top: 10px;
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: all 0.5s ease-in-out;
    }
    .player-table-wrapper.show {
      max-height: 1000px;
      opacity: 1;
    }
    .player-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: rgba(255,255,255,0.05);
    }
    .player-table th, .player-table td {
      padding: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      text-align: center;
      color: #fff;
    }
    .player-table th {
      background: rgba(255,255,255,0.1);
      font-weight: bold;
    }
    .season-nav-btn {
            background-color: rgba(107, 70, 193, 0.7);
            border: none;
            color: #fff;
            margin-right: 10px;
        }
    .season-nav-btn:hover {
            background-color: rgba(107, 70, 193, 1);
        }
    .season-nav-btn:disabled {
            background-color: rgba(107, 70, 193, 0.3);
            cursor: not-allowed;
        }
    .brand-container {
        text-align: center; /* 让文本居中对齐，便于品牌显示 */
        display: flex;
        flex-direction: column; /* 垂直排列成两行 */
        align-items: center; /* 水平居中 */
    }

    .brand-container .navbar-brand:first-child {
        font-size: 2rem; /* 上行字体较大，例如2rem（可根据需要调整为24px等） */
        font-weight: bold; /* 可选：加粗上行文本 */
        line-height: 1.2; /* 行高，防止挤压 */
    }

    .brand-container .navbar-brand:last-child {
        font-size: 1rem; /* 下行字体较小，例如1rem（可调整为14px等） */
        color: #BBB; /* 可选：让英文稍淡一些，突出中文 */
        margin-top: -5px; /* 可选：微调下行上移，避免间距过大 */
}
  </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <img src="/static/images/logo.png" alt="ALJS Logo" height="80" class="me-2">
            <div class="brand-container">
                <a class="navbar-brand" href="/">果汁百科</a>
                <a class="navbar-brand" href="/">Juicypedia</a>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/events">赛事纪录</a></li>
<!--                    <li class="nav-item"><a class="nav-link" href="/players">参赛选手</a></li>-->
<!--                    <li class="nav-item"><a class="nav-link" href="/records">战绩记录</a></li>-->
                </ul>
            </div>
        </div>
    </nav>
<div class="container my-4">
    <h1>ALJS 比赛详情 - 赛季 {{ match.match_id }}</h1>
    <div class="d-flex mb-3">
        {% set season_num = match.match_id | lower | replace('s', '') | int %}
        <a href="/match/s{{ season_num - 1 }}" class="btn season-nav-btn {{ 'disabled' if season_num <= 1 }}" aria-disabled="{{ 'true' if season_num <= 1 else 'false' }}">上一赛季</a>
        <a href="/match/s{{ season_num + 1 }}" class="btn season-nav-btn {{ 'disabled' if season_num >= 14 }}" aria-disabled="{{ 'true' if season_num >= 14 else 'false' }}">下一赛季</a>
    </div>
    <div id="teams-container"></div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(async function() {
    const res = await fetch(`/api/match/{{ match.match_id | lower }}`);
    const data = await res.json();
    const container = $('#teams-container');

    data.teams.forEach(team => {
      const card = $(`
        <div class="team-card">
          <div class="team-header">
            <div class="team-info">
              <div class="team-logo">#${team.rank}</div>
              <div class="team-name">${team.team_id}</div>
            </div>
            <div class="team-stats">
              <div><div>${team.total_score}</div><small>Total Score</small></div>
              <div><div>${team.rank_score}</div><small>Rank Score</small></div>
              <div><div>${team.total_kills}</div><small>Kills</small></div>
            </div>
          </div>
          <div class="player-table-wrapper">
            <table class="player-table">
              <thead>
                <tr>
                  <th>Player</th>
                  <th>Kills</th>
                  <th>Damage</th>
                  <th>Assists</th>
                  <th>Knockdowns</th>
                  <th>Revives</th>
                  <th>Respawns</th>
                  <th>Avg Survival</th>
                </tr>
              </thead>
              <tbody>
                ${team.players.map(p => `
                  <tr>
                    <td>${p.player_id}</td>
                    <td>${p.kills}</td>
                    <td>${p.damage}</td>
                    <td>${p.assists || 0}</td>
                    <td>${p.knockdowns || 0}</td>
                    <td>${p.revives || 0}</td>
                    <td>${p.respawns || 0}</td>
                    <td>${p.avg_survival || "0:00"}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          </div>
        </div>
      `);

      // 点击展开/收起
      card.find('.team-header').on('click', function() {
        card.find('.player-table-wrapper').toggleClass('show');
      });

      container.append(card);
    });
  });
</script>
</body>
</html>
